---
- name: Podgotovka Sistemi na web_node
  hosts: web_node
  become: true
  tasks:

# Переименовываем хост. Значение переменной будет передаваться из командной строки в ключе команды ansible-playbook при запуске из terraform
    - name: Set a hostname
      ansible.builtin.hostname:
        name: "{{ web_node_hostname }}"

# Обновляем все пакеты в системе
    - name: Update repos
      apt:
        update_cache: yes

# Устанавливаем nginx
    - name: install nginx
      apt:
        name: nginx
        state: latest




#    - name: install pytho3
#      apt:
#        name: python3
#        state: latest

#    - name: install python3-pip
#      apt:
#        name: python3-pip
#        state: latest

#    - name: install ansible
#      shell: python3 -m pip install ansible-core==2.13.1

#    - name: Create directory for playbok for Nodes
#      file: state=directory mode=0775 dest=/root/playbook_for_nodes

#    - name: Copy Playbook for nodes
#      copy: src=provision_nodes.yaml dest=/root/playbook_for_nodes
#      ignore_errors: yes

#    - name: Copy Playbook for nodes for Repeat Test
#      copy: src=provision_nodes_repeat-test.yaml dest=/root/playbook_for_nodes
#      ignore_errors: yes

#    - name: Copy nodes Inventory
#      copy: src=inventory_nodes dest=/root/playbook_for_nodes
#      ignore_errors: yes
